{"swagger":"2.0","info":{"title":"The ZeroCloud API","description":"An API definition for ZeroCloud in Goa","version":""},"host":"localhost:8080","schemes":["http"],"consumes":["application/json","application/xml","application/gob","application/x-gob"],"produces":["application/json","application/xml","application/gob","application/x-gob"],"paths":{"/accounts":{"get":{"tags":["account"],"summary":"list account","description":"Retrieve all accounts.","operationId":"account#list","responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/AccountCollection"}},"404":{"description":"Not Found"}},"schemes":["http"]},"post":{"tags":["account"],"summary":"create account","description":"Create new account","operationId":"account#create","parameters":[{"name":"payload","in":"body","required":true,"schema":{"$ref":"#/definitions/AccountPayload"}}],"responses":{"201":{"description":"Resource created","headers":{"Location":{"description":"href to created resource","type":"string","pattern":"/accounts/[0-9]+"}}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/error"}}},"schemes":["http"]}},"/accounts/{accountID}":{"get":{"tags":["account"],"summary":"show account","description":"Retrieve account with given id. IDs 1 and 2 pre-exist in the system.","operationId":"account#show","parameters":[{"name":"accountID","in":"path","description":"Account ID","required":true,"type":"integer"}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Account"}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/error"}},"404":{"description":"Not Found"}},"schemes":["http"]},"put":{"tags":["account"],"summary":"update account","description":"Change account name","operationId":"account#update","parameters":[{"name":"accountID","in":"path","description":"Account ID","required":true,"type":"integer"},{"name":"payload","in":"body","required":true,"schema":{"$ref":"#/definitions/UpdateAccountPayload"}}],"responses":{"204":{"description":"No Content"},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/error"}},"404":{"description":"Not Found"}},"schemes":["http"]},"delete":{"tags":["account"],"summary":"delete account","operationId":"account#delete","parameters":[{"name":"accountID","in":"path","description":"Account ID","required":true,"type":"integer"}],"responses":{"204":{"description":"No Content"},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/error"}},"404":{"description":"Not Found"}},"schemes":["http"]}},"/accounts/{accountID}/cloudaccounts":{"get":{"tags":["cloudaccount"],"summary":"list cloudaccount","description":"List all cloud accounts","operationId":"cloudaccount#list","parameters":[{"name":"accountID","in":"path","description":"Account ID","required":true,"type":"integer"}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/CloudaccountCollection"}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/error"}},"404":{"description":"Not Found"}},"schemes":["http"]},"post":{"tags":["cloudaccount"],"summary":"create cloudaccount","description":"Record new cloud account","operationId":"cloudaccount#create","parameters":[{"name":"accountID","in":"path","description":"Account ID","required":true,"type":"integer"},{"name":"payload","in":"body","required":true,"schema":{"$ref":"#/definitions/CloudAccountPayload"}}],"responses":{"201":{"description":"Resource created","headers":{"Location":{"description":"href to created resource","type":"string","pattern":"^/accounts/[0-9]+/cloudaccounts/[0-9]+$"}}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/error"}},"404":{"description":"Not Found"}},"schemes":["http"]}},"/accounts/{accountID}/cloudaccounts/{cloudAccountID}":{"get":{"tags":["cloudaccount"],"summary":"show cloudaccount","description":"Retrieve cloud account with given id","operationId":"cloudaccount#show","parameters":[{"name":"accountID","in":"path","description":"Account ID","required":true,"type":"integer"},{"name":"cloudAccountID","in":"path","required":true,"type":"integer"}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Cloudaccount"}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/error"}},"404":{"description":"Not Found"}},"schemes":["http"]},"delete":{"tags":["cloudaccount"],"summary":"delete cloudaccount","operationId":"cloudaccount#delete","parameters":[{"name":"accountID","in":"path","description":"Account ID","required":true,"type":"integer"},{"name":"cloudAccountID","in":"path","required":true,"type":"integer"}],"responses":{"204":{"description":"No Content"},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/error"}},"404":{"description":"Not Found"}},"schemes":["http"]},"patch":{"tags":["cloudaccount"],"summary":"update cloudaccount","operationId":"cloudaccount#update","parameters":[{"name":"accountID","in":"path","description":"Account ID","required":true,"type":"integer"},{"name":"cloudAccountID","in":"path","required":true,"type":"integer"},{"name":"payload","in":"body","required":true,"schema":{"$ref":"#/definitions/CloudAccountPayload"}}],"responses":{"204":{"description":"No Content"},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/error"}},"404":{"description":"Not Found"}},"schemes":["http"]}},"/aws/{awsAccountID}":{"get":{"tags":["aws"],"summary":"show aws","description":"Lookup the CloudAccount associated with this AWS acocunt ID","operationId":"aws#show","parameters":[{"name":"awsAccountID","in":"path","required":true,"type":"string"}],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Cloudaccount"}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/error"}},"404":{"description":"Not Found"}},"schemes":["http"]}},"/cloudevent":{"post":{"tags":["cloudevent"],"summary":"create cloudevent","description":"Save a new AWS CloudWatch event","operationId":"cloudevent#create","parameters":[{"name":"payload","in":"body","required":true,"schema":{"$ref":"#/definitions/CloudEventPayload"}}],"responses":{"201":{"description":"Resource created","headers":{"Location":{"description":"href to created resource","type":"string"}}},"400":{"description":"Bad Request","schema":{"$ref":"#/definitions/error"}}},"schemes":["http"]}},"/leases":{"get":{"tags":["lease"],"summary":"list lease","description":"Retrieve all leases.","operationId":"lease#list","responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/LeaseCollection"}},"404":{"description":"Not Found"}},"schemes":["http"]}}},"definitions":{"Account":{"title":"Mediatype identifier: application/vnd.account+json; view=default","type":"object","properties":{"created_at":{"type":"string","description":"Date of creation","example":"1987-02-14T16:27:49-08:00","format":"date-time"},"created_by":{"type":"string","description":"Email of account owner","example":"admin@bigdb.co","format":"email"},"href":{"type":"string","description":"API href of account","example":"/accounts/1"},"id":{"type":"integer","description":"ID of account","example":1,"format":"int64"},"name":{"type":"string","description":"Name of account","example":"test","minLength":3}},"description":"An account (default view)","example":{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"},"required":["id","href","name","created_at","created_by"]},"AccountCollection":{"title":"Mediatype identifier: application/vnd.account+json; type=collection","type":"array","items":{"$ref":"#/definitions/Account"},"description":"AccountCollection is the media type for an array of Account (default view)","example":[{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"},{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"}]},"AccountLink":{"title":"Mediatype identifier: application/vnd.account+json; view=link","type":"object","properties":{"href":{"type":"string","description":"API href of account","example":"/accounts/1"},"id":{"type":"integer","description":"ID of account","example":1,"format":"int64"}},"description":"An account (link view)","example":{"href":"/accounts/1","id":1},"required":["id","href"]},"AccountPayload":{"title":"AccountPayload","type":"object","properties":{"lease_expires_in":{"type":"integer","description":"The lease will expire in this many lease_expires_in_units","default":3,"example":3,"format":"int64"},"lease_expires_in_units":{"type":"string","description":"The units for the lease_expires_in field","default":"days","example":"days","enum":["seconds","minutes","hours","days"]},"name":{"type":"string","description":"Name of account","example":"BigDB","minLength":3}},"example":{"lease_expires_in":3,"lease_expires_in_units":"days","name":"BigDB"},"required":["name"]},"AccountTiny":{"title":"Mediatype identifier: application/vnd.account+json; view=tiny","type":"object","properties":{"href":{"type":"string","description":"API href of account","example":"/accounts/1"},"id":{"type":"integer","description":"ID of account","example":1,"format":"int64"},"name":{"type":"string","description":"Name of account","example":"test","minLength":3}},"description":"An account (tiny view)","example":{"href":"/accounts/1","id":1,"name":"test"},"required":["id","href","name"]},"CloudAccountPayload":{"title":"CloudAccountPayload","type":"object","properties":{"assume_role_arn":{"type":"string","example":"arn:aws:iam::788612350743:role/ZeroCloud","minLength":4},"assume_role_external_id":{"type":"string","example":"bigdb","minLength":1},"cloudprovider":{"type":"string","example":"AWS","minLength":3},"name":{"type":"string","description":"Name of account","example":"BigDB.co's perf testing AWS account","minLength":3},"upstream_account_id":{"type":"string","example":"98798079879","minLength":4}},"example":{"assume_role_arn":"arn:aws:iam::788612350743:role/ZeroCloud","assume_role_external_id":"bigdb","cloudprovider":"AWS","name":"BigDB.co's perf testing AWS account","upstream_account_id":"98798079879"},"required":["name","cloudprovider","upstream_account_id","assume_role_arn","assume_role_external_id"]},"CloudEventPayload":{"title":"CloudEventPayload","type":"object","properties":{"Message":{"type":"object","properties":{"account":{"type":"string","description":"AWS Account","example":"868768768"},"detail":{"type":"object","properties":{"instance-id":{"type":"string","description":"EC2 Instance ID","example":"i-0a74797fd283b53de"},"state":{"type":"string","description":"EC2 Instance State","example":"running"}},"example":{"instance-id":"i-0a74797fd283b53de","state":"running"},"required":["instance-id","state"]},"detail-type":{"type":"string","description":"CloudWatch Event Detail Type","example":"EC2 Instance State-change Notification"},"id":{"type":"string","description":"CloudWatch Event ID","example":"2ecfc931-d9f2-4b25-9c00-87e6431d09f7"},"region":{"type":"string","description":"CloudWatch Event Region","example":"us-west-1"},"source":{"type":"string","description":"CloudWatch Event Source","example":"aws.ec2"},"time":{"type":"string","description":"CloudWatch Event Timestamp","example":"2016-08-06T20:53:38Z","format":"date-time"},"version":{"type":"string","description":"CloudWatch Event Version","example":"0"}},"example":{"account":"868768768","detail":{"instance-id":"i-0a74797fd283b53de","state":"running"},"detail-type":"EC2 Instance State-change Notification","id":"2ecfc931-d9f2-4b25-9c00-87e6431d09f7","region":"us-west-1","source":"aws.ec2","time":"2016-08-06T20:53:38Z","version":"0"},"required":["account"]},"MessageId":{"type":"string","description":"CloudWatch Event ID","example":"fb7dad1a-ccee-5ac8-ac38-fd3a9c7dfe35"},"SQSPayloadBase64":{"type":"string","description":"SQS Payload Base64","example":"ewogICAgIkF0dHJpYnV0Z........5TlpRPT0iCn0="},"Timestamp":{"type":"string","description":"CloudWatch Event Timestamp","example":"2016-08-06T20:53:39.209Z","format":"date-time"},"TopicArn":{"type":"string","description":"CloudWatch Event Topic ARN","example":"arn:aws:sns:us-west-1:788612350743:BigDBEC2Events"},"Type":{"type":"string","description":"CloudWatch Event Type","example":"Notification"}},"example":{"Message":{"account":"868768768","detail":{"instance-id":"i-0a74797fd283b53de","state":"running"},"detail-type":"EC2 Instance State-change Notification","id":"2ecfc931-d9f2-4b25-9c00-87e6431d09f7","region":"us-west-1","source":"aws.ec2","time":"2016-08-06T20:53:38Z","version":"0"},"MessageId":"fb7dad1a-ccee-5ac8-ac38-fd3a9c7dfe35","SQSPayloadBase64":"ewogICAgIkF0dHJpYnV0Z........5TlpRPT0iCn0=","Timestamp":"2016-08-06T20:53:39.209Z","TopicArn":"arn:aws:sns:us-west-1:788612350743:BigDBEC2Events","Type":"Notification"},"required":["Message"]},"Cloudaccount":{"title":"Mediatype identifier: application/vnd.cloudaccount+json","type":"object","properties":{"account":{"$ref":"#/definitions/AccountTiny"},"assume_role_arn":{"type":"string","description":"The Role ARN which allows ZeroCloud to use AssumeRole.  See https://github.com/tleyden/zerocloud/issues/1","example":"arn:aws:iam::788612350743:role/ZeroCloud","minLength":4},"assume_role_external_id":{"type":"string","description":"The customer and aws account specific External ID that needs to be passed when using AssumeRole.  See https://github.com/tleyden/zerocloud/issues/1","example":"bigdb","minLength":1},"cloudprovider":{"type":"string","example":"AWS","minLength":3},"href":{"type":"string","description":"API href of cloud account","example":"/accounts/1/cloudaccounts/1"},"id":{"type":"integer","description":"ID of cloud account","example":1,"format":"int64"},"links":{"$ref":"#/definitions/CloudaccountLinks"},"name":{"type":"string","description":"Name of account","example":"BigDB.co's perf testing AWS account","minLength":3},"upstream_account_id":{"type":"string","example":"98798079879","minLength":4}},"description":"A CloudAccount (default view)","example":{"account":{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"},"assume_role_arn":"arn:aws:iam::788612350743:role/ZeroCloud","assume_role_external_id":"bigdb","cloudprovider":"AWS","href":"/accounts/1/cloudaccounts/1","id":1,"links":{"account":{"href":"/accounts/1","id":1}},"name":"BigDB.co's perf testing AWS account","upstream_account_id":"98798079879"},"required":["id","href","name","cloudprovider","upstream_account_id","assume_role_arn","assume_role_external_id"]},"CloudaccountCollection":{"title":"Mediatype identifier: application/vnd.cloudaccount+json; type=collection","type":"array","items":{"$ref":"#/definitions/Cloudaccount"},"description":"CloudaccountCollection is the media type for an array of Cloudaccount (default view)","example":[{"account":{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"},"assume_role_arn":"arn:aws:iam::788612350743:role/ZeroCloud","assume_role_external_id":"bigdb","cloudprovider":"AWS","href":"/accounts/1/cloudaccounts/1","id":1,"links":{"account":{"href":"/accounts/1","id":1}},"name":"BigDB.co's perf testing AWS account","upstream_account_id":"98798079879"}]},"CloudaccountLinks":{"title":"CloudaccountLinks","type":"object","properties":{"account":{"$ref":"#/definitions/AccountLink"}},"description":"CloudaccountLinks contains links to related resources of Cloudaccount.","example":{"account":{"href":"/accounts/1","id":1}}},"Cloudevent":{"title":"Mediatype identifier: application/vnd.cloudevent+json; view=default","type":"object","properties":{"aws_account_id":{"type":"string","example":"Adipisci mollitia impedit sit quae."},"href":{"type":"string","description":"API href of cloud event","example":"/cloudevents/1"},"id":{"type":"integer","description":"ID of cloud event","example":1,"format":"int64"},"links":{"$ref":"#/definitions/CloudeventLinks"}},"description":"A CloudEvent -- AWS CloudWatch Event (default view)","example":{"aws_account_id":"Adipisci mollitia impedit sit quae.","href":"/cloudevents/1","id":1},"required":["id","href","aws_account_id"]},"CloudeventLinks":{"title":"CloudeventLinks","type":"object","description":"CloudeventLinks contains links to related resources of Cloudevent."},"Lease":{"title":"Mediatype identifier: application/vnd.lease+json; view=default","type":"object","properties":{"account":{"$ref":"#/definitions/Account"},"account_id":{"type":"integer","description":"ID of Account that owns Lease","example":7246627695289446993,"format":"int64"},"cloud_account":{"$ref":"#/definitions/Cloudaccount"},"cloud_account_id":{"type":"integer","description":"ID of CloudAccount that owns Lease","example":9210636783638244582,"format":"int64"},"cloud_event":{"$ref":"#/definitions/Cloudevent"},"cloud_event_id":{"type":"integer","description":"ID of CloudEvent that owns Lease","example":7913271607741046991,"format":"int64"},"created_at":{"type":"string","description":"Date of creation","example":"1988-07-02T08:25:58-07:00","format":"date-time"},"expires":{"type":"string","description":"The datetime when this lease expires","example":"1973-09-29T21:14:03-07:00","format":"date-time"},"href":{"type":"string","description":"API href of lease","example":"/leases/1"},"id":{"type":"integer","description":"ID of lease","example":1,"format":"int64"},"links":{"$ref":"#/definitions/LeaseLinks"},"state":{"type":"string","description":"The current state of the lease","example":"Active"}},"description":"A lease (default view)","example":{"account":{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"},"account_id":7246627695289446993,"cloud_account":{"account":{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"},"assume_role_arn":"arn:aws:iam::788612350743:role/ZeroCloud","assume_role_external_id":"bigdb","cloudprovider":"AWS","href":"/accounts/1/cloudaccounts/1","id":1,"links":{"account":{"href":"/accounts/1","id":1}},"name":"BigDB.co's perf testing AWS account","upstream_account_id":"98798079879"},"cloud_account_id":9210636783638244582,"cloud_event":{"aws_account_id":"Adipisci mollitia impedit sit quae.","href":"/cloudevents/1","id":1},"cloud_event_id":7913271607741046991,"created_at":"1988-07-02T08:25:58-07:00","expires":"1973-09-29T21:14:03-07:00","href":"/leases/1","id":1,"links":{"account":{"href":"/accounts/1","id":1}},"state":"Active"},"required":["id","href","expires","state","account_id","cloud_event_id","cloud_account_id"]},"LeaseCollection":{"title":"Mediatype identifier: application/vnd.lease+json; type=collection","type":"array","items":{"$ref":"#/definitions/Lease"},"description":"LeaseCollection is the media type for an array of Lease (default view)","example":[{"account":{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"},"account_id":7246627695289446993,"cloud_account":{"account":{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"},"assume_role_arn":"arn:aws:iam::788612350743:role/ZeroCloud","assume_role_external_id":"bigdb","cloudprovider":"AWS","href":"/accounts/1/cloudaccounts/1","id":1,"links":{"account":{"href":"/accounts/1","id":1}},"name":"BigDB.co's perf testing AWS account","upstream_account_id":"98798079879"},"cloud_account_id":9210636783638244582,"cloud_event":{"aws_account_id":"Adipisci mollitia impedit sit quae.","href":"/cloudevents/1","id":1},"cloud_event_id":7913271607741046991,"created_at":"1988-07-02T08:25:58-07:00","expires":"1973-09-29T21:14:03-07:00","href":"/leases/1","id":1,"links":{"account":{"href":"/accounts/1","id":1}},"state":"Active"},{"account":{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"},"account_id":7246627695289446993,"cloud_account":{"account":{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"},"assume_role_arn":"arn:aws:iam::788612350743:role/ZeroCloud","assume_role_external_id":"bigdb","cloudprovider":"AWS","href":"/accounts/1/cloudaccounts/1","id":1,"links":{"account":{"href":"/accounts/1","id":1}},"name":"BigDB.co's perf testing AWS account","upstream_account_id":"98798079879"},"cloud_account_id":9210636783638244582,"cloud_event":{"aws_account_id":"Adipisci mollitia impedit sit quae.","href":"/cloudevents/1","id":1},"cloud_event_id":7913271607741046991,"created_at":"1988-07-02T08:25:58-07:00","expires":"1973-09-29T21:14:03-07:00","href":"/leases/1","id":1,"links":{"account":{"href":"/accounts/1","id":1}},"state":"Active"},{"account":{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"},"account_id":7246627695289446993,"cloud_account":{"account":{"created_at":"1987-02-14T16:27:49-08:00","created_by":"admin@bigdb.co","href":"/accounts/1","id":1,"name":"test"},"assume_role_arn":"arn:aws:iam::788612350743:role/ZeroCloud","assume_role_external_id":"bigdb","cloudprovider":"AWS","href":"/accounts/1/cloudaccounts/1","id":1,"links":{"account":{"href":"/accounts/1","id":1}},"name":"BigDB.co's perf testing AWS account","upstream_account_id":"98798079879"},"cloud_account_id":9210636783638244582,"cloud_event":{"aws_account_id":"Adipisci mollitia impedit sit quae.","href":"/cloudevents/1","id":1},"cloud_event_id":7913271607741046991,"created_at":"1988-07-02T08:25:58-07:00","expires":"1973-09-29T21:14:03-07:00","href":"/leases/1","id":1,"links":{"account":{"href":"/accounts/1","id":1}},"state":"Active"}]},"LeaseLinks":{"title":"LeaseLinks","type":"object","properties":{"account":{"$ref":"#/definitions/AccountLink"}},"description":"LeaseLinks contains links to related resources of Lease.","example":{"account":{"href":"/accounts/1","id":1}}},"UpdateAccountPayload":{"title":"UpdateAccountPayload","type":"object","properties":{"name":{"type":"string","description":"Name of account","example":"test","minLength":3}},"example":{"name":"test"},"required":["name"]},"error":{"title":"Mediatype identifier: application/vnd.goa.error","type":"object","properties":{"code":{"type":"string","description":"an application-specific error code, expressed as a string value.","example":"invalid_value"},"detail":{"type":"string","description":"a human-readable explanation specific to this occurrence of the problem.","example":"Value of ID must be an integer"},"id":{"type":"string","description":"a unique identifier for this particular occurrence of the problem.","example":"3F1FKVRR"},"meta":{"type":"object","description":"a meta object containing non-standard meta-information about the error.","example":{"timestamp":1458609066},"additionalProperties":true},"status":{"type":"string","description":"the HTTP status code applicable to this problem, expressed as a string value.","example":"400"}},"description":"Error response media type (default view)","example":{"code":"invalid_value","detail":"Value of ID must be an integer","id":"3F1FKVRR","meta":{"timestamp":1458609066},"status":"400"}}},"responses":{"NoContent":{"description":"No Content"},"NotFound":{"description":"Not Found"},"OK":{"description":"OK","schema":{"$ref":"#/definitions/Account"}}}}